<div class="mb-3">
  <h1 class="text-secondary-yellow">Gestión de Frecuencias</h1>
  <ol class="breadcrumb breadcrumb-arrows">
    <li class="breadcrumb-item">
      <a [routerLink]="['/inicio']" class="text-primary-blue">Inicio</a>
    </li>
    <li class="breadcrumb-item active">
      <a href="#" class="text-secondary-yellow">Frecuencias</a>
    </li>
  </ol>
</div>

<div class="row mb-3">
  <div class="col">
    <div class="d-flex justify-content-between align-items-center">
      <h2>Listado de Frecuencias</h2>
      <button class="btn btn-primary" [routerLink]="['/frecuencias/crear']">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-plus" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <path d="M12 5l0 14"></path>
          <path d="M5 12l14 0"></path>
        </svg>
        Nueva Frecuencia
      </button>
    </div>
  </div>
</div>



<div class="row row-cards">
  @if (isLoading) {
    <div class="col-12 d-flex justify-content-center">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Cargando...</span>
      </div>
    </div>
  } @else if (frequencies.length === 0) {
    <div class="col-12">
      <div class="card">
        <div class="card-body text-center py-4">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock mb-2 text-muted" width="40" height="40" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
            <circle cx="12" cy="12" r="9"></circle>
            <polyline points="12 7 12 12 15 15"></polyline>
          </svg>
          <h3>No hay frecuencias disponibles</h3>
          <p class="text-muted">Crea una nueva frecuencia para comenzar a gestionar tus horarios</p>
          <div>
            <button class="btn btn-primary" [routerLink]="['/frecuencias/crear']">
              Crear primera frecuencia
            </button>
          </div>
        </div>
      </div>
    </div>
  } @else {
    @for (frequency of frequencies; track frequency.id) {
      <div class="col-md-6 col-lg-4">
        <div class="card route-card h-100">
          <div class="card-body d-flex flex-column">
            <div class="d-flex justify-content-between mb-3">
              <h3 class="card-title">
                @if (frequency.originCity && frequency.destinationCity) {
                  {{ frequency.originCity.name }} - {{ frequency.destinationCity.name }}
                } @else {
                  Ciudades ID: {{ frequency.originCityId }} - {{ frequency.destinationCityId }}
                }
              </h3>
              <div class="status-indicator">
                <span class="status-badge d-flex align-items-center" [ngClass]="{
                  'status-active': frequency.status === 'activo' || frequency.status === 'Activo',
                  'status-inactive': frequency.status === 'inactivo' || frequency.status === 'Inactivo',
                  'status-pending': frequency.status === 'pendiente' || frequency.status === 'Pendiente'
                }">
                  @if (frequency.status === 'activo' || frequency.status === 'Activo') {
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-circle-check me-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                      <path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" />
                      <path d="M9 12l2 2l4 -4" />
                    </svg>
                  } @else if (frequency.status === 'inactivo' || frequency.status === 'Inactivo') {
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-circle-x me-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                      <path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" />
                      <path d="M10 10l4 4m0 -4l-4 4" />
                    </svg>
                  } @else {
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock me-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                      <path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0" />
                      <path d="M12 7v5l3 3" />
                    </svg>
                  }
                  {{ frequency.status }}
                </span>
              </div>
            </div>
            <div class="route-info flex-grow-1">
              <div>
                <strong>Origen:</strong>
                @if (frequency.originCity) {
                  {{ frequency.originCity.name }}
                  @if (frequency.originCity.province) {
                    ({{ frequency.originCity.province }})
                  }
                } @else {
                  ID: {{ frequency.originCityId }}
                }
              </div>
              <div>
                <strong>Destino:</strong>
                @if (frequency.destinationCity) {
                  {{ frequency.destinationCity.name }}
                  @if (frequency.destinationCity.province) {
                    ({{ frequency.destinationCity.province }})
                  }
                } @else {
                  ID: {{ frequency.destinationCityId }}
                }
              </div>
              <div><strong>Hora de salida:</strong> {{ formatTimeDisplay(frequency.departureTime) }}</div>
              <div>
                <strong>Resolución ANT:</strong>
                @if (frequency.antResolution) {
                  <a href="{{ frequency.antResolution }}" target="_blank" class="text-primary">Ver PDF</a>
                } @else {
                  <span class="text-muted">No disponible</span>
                }
              </div>
            </div>
            <div class="card-actions mt-3 d-flex justify-content-end">
              <a [routerLink]="['/frecuencias', frequency.id]" class="btn btn-sm btn-outline-primary me-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-eye" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                  <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0"></path>
                  <path d="M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6"></path>
                </svg>
                Ver
              </a>
              <a [routerLink]="['/frecuencias/editar', frequency.id]" class="btn btn-sm btn-outline-primary">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-edit" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                  <path d="M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1"></path>
                  <path d="M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z"></path>
                  <path d="M16 5l3 3"></path>
                </svg>
                Editar
              </a>
            </div>
          </div>
        </div>
      </div>
    }
  }
</div> 